#!/bin/bash
if [ -z "$IP_FILE_LIST" ];  then
   echo "Please set IP_FILE_LIST to full path of file with IP list"
   exit 1
fi

if [ -z "$OUTDIR" ]; then
   echo "Please set OUTDIR to output dir"
   exit 1
fi

if [ -z "$TCPPORT" ]; then
   echo "Please set TCPPORT to port"
   exit 1
fi
outfile=$OUTDIR/Sweep_TCP_$TCPPORT.txt

rm $outfile -f
nmap -n -iL $IP_FILE_LIST -p $TCPPORT -oG /tmp/nmapOut.txt > nul
cat /tmp/nmapOut.txt | grep Ports: | grep open | cut -d " " -f 2 > $outfile
