#! /usr/bin/python
import os
import socket
import sys

# Parameter checking
try:
   rhost=os.environ['RHOST']
except OSError:
   print("Please set RHOST environment variable")
   sys.exit(0)
try:
   email=os.environ['RUSER_EMAIL']
except OSError:
   print("Please set RUSER_EMAIL environment variable")
   sys.exit(0)

# Ethernet socket, open as a stream
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
try:
    # Establish connection with SMTP (TCP:25)
    conn=s.connect((rhost,25))
    # receive banner with 1KB buffer
    banner=s.recv(1024)
    print(banner)
    s.send('HELO 127.0.0.1'+ '\r\n')
    hello=s.recv(1024)
    print(hello)
    s.send('VRFY '+ email + '\r\n')
    result=s.recv(1024)
    print(ipAddress+" "+result)
except Exception:
    pass
finally:
    s.close()

