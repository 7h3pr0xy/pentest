#!/bin/bash
# -- SMB Info gatherer for given IP address
# /usr/share/nmap/scripts/smb-enum-domains.nse
# /usr/share/nmap/scripts/smb-enum-groups.nse
# /usr/share/nmap/scripts/smb-enum-processes.nse
# /usr/share/nmap/scripts/smb-enum-services.nse
# /usr/share/nmap/scripts/smb-enum-sessions.nse
# /usr/share/nmap/scripts/smb-enum-shares.nse
# /usr/share/nmap/scripts/smb-enum-users.nse
# /usr/share/nmap/scripts/smb-mbenum.nse
# /usr/share/nmap/scripts/smb-os-discovery.nse
# /usr/share/nmap/scripts/smb-protocols.nse
# /usr/share/nmap/scripts/smb-server-stats.nse
/usr/share/nmap/scripts/smb-system-info.nse
/usr/share/nmap/scripts/smb-vuln-conficker.nse
/usr/share/nmap/scripts/smb-vuln-cve-2017-7494.nse
/usr/share/nmap/scripts/smb-vuln-cve2009-3103.nse
/usr/share/nmap/scripts/smb-vuln-ms06-025.nse
/usr/share/nmap/scripts/smb-vuln-ms07-029.nse
/usr/share/nmap/scripts/smb-vuln-ms08-067.nse
/usr/share/nmap/scripts/smb-vuln-ms10-054.nse
/usr/share/nmap/scripts/smb-vuln-ms10-061.nse
/usr/share/nmap/scripts/smb-vuln-ms17-010.nse
/usr/share/nmap/scripts/smb-vuln-regsvc-dos.nse
/usr/share/nmap/scripts/smb2-capabilities.nse
/usr/share/nmap/scripts/smb2-security-mode.nse
/usr/share/nmap/scripts/smb2-time.nse
/usr/share/nmap/scripts/smb2-vuln-uptime.nse



# Bail if no arguments
if [ $# -eq 0 ]; then
    echo "Usage: $0 [IP address] [dest folder]"
    echo " i.e. $0 10.0.0.1 ../2-Info"
    exit 1
fi
clear
enum4linux -v -a $1 > $2/$1-SMB-Enum4Linux.txt
nmap -sU -sS --script=smb-enum-domains,smb-enum-groups,smb-enum-processes,smb-enum-services,smb-enum-sessions,smb-enum-users,smb-enum-shares,smb-os-discovery,smb-protocols,smb-server-stats,smb-system-info  -p U:137,T:139,T:445 $1 > $2/$1-SMB-NMAP.txt
